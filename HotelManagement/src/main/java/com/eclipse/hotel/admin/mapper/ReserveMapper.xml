<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper     
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"     
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.eclipse.hotel.admin.mapper.ReserveMapper">
<!--캘린더에 출력할 예약리스트  -->
<select id="reserveList" resultType="r_reserv_VO">
SELECT reservecode,check_in,to_date(to_date(check_out,'yyyy-mm-dd')+1) as check_out,rnum,m_num
FROM room_reserve
</select>

<!-- 선택한 예약정보 -->
<select id="selectlist" parameterType="int" resultType="r_reserv_VO">
select r.*, i.STANDPERSON, i.MAX_PERSON
from room_reserve r, room_info i
where r.rnum = i.rnum
and r.reservecode=#{reservecode}
</select>

<!-- 선택한 예약멤버 -->
<select id="rmember" parameterType="int" resultType="memberVO">
select * from member 
where m_num=#{m_num}
</select>

<!--예약 삭제  -->
<delete id="delreserve" parameterType="String">
delete from room_reserve
where reservecode=#{reservecode}
</delete>

<!--예약 수정  -->
<update id="update" parameterType="r_reserv_VO">
update room_reserve set 
rnum=#{rnum},check_in=#{check_in},check_out=#{check_out},
person=#{person},extracode=#{extracode},extracharge=#{extracharge},
reservedate=sysdate,r_price=#{r_price},p_price=#{p_price}
where reservecode=#{reservecode}
</update>

<!--예약된 방요금표  -->
<select id="searchtype" parameterType="int" resultType="String">
select price from room_info where rnum=#{rnum}
</select>

<!--예약된방 시즌요금  -->
<select id="getpay" parameterType="String" resultType="int">
select season from room_price where price=#{paytype}
</select>

<!--예약된방 비시즌요금  -->
<select id="getnonpay" parameterType="String" resultType="int">
select nonseason from room_price where price=#{paytype}
</select>

<!--예약된방 기준인원  -->
<select id="standperson" parameterType="int" resultType="int">
select standperson from room_info 
where rnum=#{rnum}
</select>

<!-- 방번호 리스트 -->
<select id="rnumList" resultType="r_infoVO">
SELECT rnum FROM room_info
ORDER BY 1
</select>

<!--추가요금  -->
<select id="getextracharge" parameterType="String" resultType="int">
select e_price from extracharge where extracode=#{string} 
</select>

<!-- 호실정보 -->
<select id="roomInfo" parameterType="int" resultType="r_infoVO">
select standperson,max_person from room_info where rnum=#{rnum}
</select>

</mapper>